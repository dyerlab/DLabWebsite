<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>dyerlab</title>
<link>https://dyerlab.org/index.html</link>
<atom:link href="https://dyerlab.org/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.3.450</generator>
<lastBuildDate>Mon, 20 Nov 2023 05:00:00 GMT</lastBuildDate>
<item>
  <title>Spotted Turtel Assignment Presentation</title>
  <link>https://dyerlab.org/posts/2023-11-20-Turtle-Assignment/index.html</link>
  <description><![CDATA[ 




<p><img src="https://dyerlab.org/posts/2023-11-20-Turtle-Assignment/featured.png" class="img-fluid" alt="Population Assignment for Spotted Turtles"></p>
<p><a href="TurtleMeeting20231120/index.html">Here</a> is a link to the presentation that I gave to the state managers.</p>



 ]]></description>
  <guid>https://dyerlab.org/posts/2023-11-20-Turtle-Assignment/index.html</guid>
  <pubDate>Mon, 20 Nov 2023 05:00:00 GMT</pubDate>
  <media:content url="https://dyerlab.org/posts/2023-11-20-Turtle-Assignment/featured.png" medium="image" type="image/png" height="81" width="144"/>
</item>
<item>
  <title>Population Graphs Re-Incarnated</title>
  <link>https://dyerlab.org/posts/2023-11-03-PopulationGraphs_Reincarnated/index.html</link>
  <description><![CDATA[ 




<p><img src="https://dyerlab.org/posts/2023-11-03-PopulationGraphs_Reincarnated/featured.png" class="img-fluid" alt="GUI interface for PopulationGraphs"></p>
<p>Time to get some basic one-graph analytics put together. I’ll update as progress is made.</p>



 ]]></description>
  <guid>https://dyerlab.org/posts/2023-11-03-PopulationGraphs_Reincarnated/index.html</guid>
  <pubDate>Fri, 03 Nov 2023 04:00:00 GMT</pubDate>
  <media:content url="https://dyerlab.org/posts/2023-11-03-PopulationGraphs_Reincarnated/featured.png" medium="image" type="image/png" height="136" width="144"/>
</item>
<item>
  <title>Student Orientation</title>
  <link>https://dyerlab.org/posts/2023-10-21-Orientation/index.html</link>
  <description><![CDATA[ 




<p>Here are the slides I provided for today’s presentations.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://docs.google.com/presentation/d/e/2PACX-1vTBi_dhh06JMgR2E-0N-MhBrTyodJG2oRSX04w8SfX-1TBGUlNMHbqxG1UtB-C69GXKSz9WYy2JSm42/pub?start=false&amp;loop=false&amp;delayms=3000"><img src="https://dyerlab.org/posts/2023-10-21-Orientation/featured.png" class="img-fluid figure-img"></a></p>
</figure>
</div>



 ]]></description>
  <guid>https://dyerlab.org/posts/2023-10-21-Orientation/index.html</guid>
  <pubDate>Sat, 21 Oct 2023 04:00:00 GMT</pubDate>
  <media:content url="https://dyerlab.org/posts/2023-10-21-Orientation/featured.png" medium="image" type="image/png" height="115" width="144"/>
</item>
<item>
  <title>Continued Enrollment Increases</title>
  <link>https://dyerlab.org/posts/2023-08-28-Enrollment/index.html</link>
  <description><![CDATA[ 




<p>Despite the ever present threat of the <em>Demographic Cliff</em> in incoming student engagement that is proposed to be right around the corner every year by some in the academy, the <a href="https://ces.vcu.edu">Center for Environmental Studies</a> continues to increase enrollment numbers.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://dyerlab.org/posts/2023-08-28-Enrollment/featured.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Historical trends in the number of seats filled in both core ENVS courses (blue) as well as across all the courses offered by the unit (green).</figcaption>
</figure>
</div>
<p>Starting in 2015, when I had the privilege of becoming the Director of Undergraduate Programs, and building momentum since 2017 when I became the Director of the Center, I’ve worked directly with the faculty and administration to take a curriculum that had sat fallow since its inception and began to modernize it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">priorSCH <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1229</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2977</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3287</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3547</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3785</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4132</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4168</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4023</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4079</span>)</span>
<span id="cb1-2">postSCH <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4788</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4613</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5182</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5029</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5700</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5723</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5163</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5425</span>)</span></code></pre></div>
</div>
<p>The data show the consequences of these decisions with historical averages in the number of student contact hours generated as 3469.7 and those following the initiation of full curriculum changes as 5202.9—an increase of 149.95%!</p>



 ]]></description>
  <guid>https://dyerlab.org/posts/2023-08-28-Enrollment/index.html</guid>
  <pubDate>Mon, 28 Aug 2023 04:00:00 GMT</pubDate>
  <media:content url="https://dyerlab.org/posts/2023-08-28-Enrollment/featured.png" medium="image" type="image/png" height="120" width="144"/>
</item>
<item>
  <title>Coagulating Samples By Hydrologic Units; or‘How I learned to HUC my data…’</title>
  <link>https://dyerlab.org/posts/2023-07-19-HUCs/index.html</link>
  <description><![CDATA[ 




<blockquote class="blockquote">
<p>The Watershed Boundary Dataset (WBD) maps the full areal extent of surface water drainage for the U.S. using a hierarchical system of nesting hydrologic units at various scales, each with an assigned hydrologic unit code (<a href="https://enviroatlas.epa.gov/enviroatlas/glossary/glossary.html#huc">HUC</a>). HUCs are delineated and georeferenced to U.S. Geological Survey (USGS) 1:24,000 scale topographic base maps according to compilation criteria monitored by the national <a href="https://acwi.gov/spatial/">Subcommittee on Spatial Water Data</a>.</p>
</blockquote>
<p>For this exercise I’m going to use a the hydrologic regions that represent “large river basins” designated as <code>HUC4</code>. So, how do we get these spatial extents?</p>
<ol type="1">
<li>We could go to the WBD website and download fileGDB for each state and then go from there, or…</li>
<li>We could look and see that someone in the <code>R</code> community has already done this for us and we can use their package.</li>
</ol>
<p>I’m going to go with the second option.</p>
<section id="getting-huc-representation" class="level2">
<h2 class="anchored" data-anchor-id="getting-huc-representation">Getting HUC Representation</h2>
<p>So for this, I found a utility package by Mazama Science that has a function <code>getHUCName(lat,lon)</code> that seems to be exactly what I need. So, I’ll use this. If you do not have this package already installed, execute the following:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-1_0b8bda1286845a05f6500fd18cfba0fc">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MAZAMASpatialUtils"</span>)</span></code></pre></div>
</div>
<p>Then load it into your workspace as:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-2_a7d0d272e83c6867ef01f66eb992d8bc">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(MazamaSpatialUtils)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE</code></pre>
</div>
</div>
<p>The library comes with a few spatial data sets already installed, which you can see:</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-3_aaa1ecd21495d24a04c1b3675c5ad7f3">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setSpatialDataDir</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"./data/"</span>)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">installedSpatialData</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   SimpleCountries -- Simplified version of the TMWorldBorders 
SimpleCountriesEEZ -- Simplified version of EEZCountries 
   SimpleTimezones -- Simplified version of WorldTimezones </code></pre>
</div>
</div>
<p>unfortunately, this does not include the WBD data set for HUC4, so we’ll have to install it locally. To do this, we designate a location for them to be stored (n.b., they are semi-large entities) and I’ll use a folder I created right under this file named (aptly) <code>data</code> and then have it installed there. It took me a bit of snooping around to find the right location of the data sets. As of the writing of this document, the folder is <a href="http://data.mazamascience.com/MazamaSpatialUtils/Spatial_0.8/">here</a> and you can go look in there to see the coding. The WBD files are not part of the documentation of the package (at least in the help file for the <code>getHUCName()</code> or the vignettes).</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-4_6953501db0f241b3aa7862f4b3119fb1">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">installSpatialData</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dataset=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WBDHU4"</span> )</span></code></pre></div>
</div>
<p>Now, we can verify that the HUC4 data is installed.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-5_8d2a3feda6ea18dff7ca8827c118e27f">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">installedSpatialData</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   SimpleCountries -- Simplified version of the TMWorldBorders 
SimpleCountriesEEZ -- Simplified version of EEZCountries 
   SimpleTimezones -- Simplified version of WorldTimezones 
            WBDHU4 -- Watershed boundary level-4 hydrologic units 
         WBDHU4_01 -- Watershed boundary level-4 hydrologic units (simplified to 1%)
         WBDHU4_02 -- Watershed boundary level-4 hydrologic units (simplified to 2%)
         WBDHU4_05 -- Watershed boundary level-4 hydrologic units (simplified to 5%)</code></pre>
</div>
</div>
<p>Now, we can figure out what HUC4 is for a specific locale. We need to first load in the data set and then we can query values (here is the designation for Richmond VA).</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-6_14ff7b1e54e558887fe6303816f798cb">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loadSpatialData</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WBDHU4"</span>)</span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getHUCName</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longitude =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">77.4360</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">latitude =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.5407</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dataset =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WBDHU4"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lower Chesapeake"</code></pre>
</div>
</div>
<p>Cool (though it is a bit slow).</p>
</section>
<section id="applying-to-genetic-data-sets" class="level2">
<h2 class="anchored" data-anchor-id="applying-to-genetic-data-sets">Applying to Genetic Data Sets</h2>
<p>So let’s apply this to the larger turtle data set. Here I have a 1400 indivduals genotyped for 930 SNP loci. The meta data for each individual is</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-7_e0335a25a2615e1158580335a4a2eee7">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">load</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all_data.rda"</span>)</span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(data)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Locale"     "Population" "ID"         "Target"     "Longitude" 
[6] "Latitude"  </code></pre>
</div>
</div>
<p>Where the values in <code>Population</code> are the ones that I’m going to collapse samples into. So, what I want is to be able to find the HUC-4 designation for all Population values.</p>
<p>So, there are some functions in my <code>gstudio</code> package that will help out. The <code>strata_coordinates()</code> function takes the barycenter of a set of samples and returns a <code>data.frame</code> with the coordinates.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-8_7002c0c991ebe398288bba3cdc7bf14a">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>( gstudio )</span>
<span id="cb14-2">coords <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strata_coordinates</span>( data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stratum =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population"</span>)</span>
<span id="cb14-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(coords)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Stratum"   "Longitude" "Latitude" </code></pre>
</div>
</div>
<p>The function seems to take a bit of time to run. For example, to do the single coordinate above, on my MacStudio desktop, it takes.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-9_55167e8042879cf6f40ed884db617f4b">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">start <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.time</span>()</span>
<span id="cb16-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getHUCName</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longitude =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">77.4360</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">latitude =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.5407</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dataset =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WBDHU4"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lower Chesapeake"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">end <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.time</span>()</span>
<span id="cb18-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>( end <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 9.182024 secs</code></pre>
</div>
</div>
<p>It turns out that at the current speed, it should take (<code>nrow(coords) * difftime(end,start,units="mins")</code>), which is about perfect for me to go grab a cup of tea while it is running.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-10_80540d99ac8047f6b3d2b7cc08bc73a8">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">coords<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>HUC4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getHUCName</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longitude =</span> coords<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Longitude,</span>
<span id="cb20-2">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">latitude =</span> coords<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Latitude,</span>
<span id="cb20-3">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dataset =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WBDHU4"</span>) )</span></code></pre></div>
</div>
<p>which I can now map back onto my original data file.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-11_e86a23c4e8105fed388b72b541c9e62f">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>( tidyverse )</span>
<span id="cb21-2">data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(  coords <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Population =</span> Stratum, HUC4) ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb21-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>( Locale, HUC4 ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Locale                                          HUC4    
 Length:1318        Delaware-Mid Atlantic Coastal     :159  
 Class :character   Massachusetts-Rhode Island Coastal:101  
 Mode  :character   Maine Coastal                     : 81  
                    Chowan-Roanoke                    : 76  
                    Lower Chesapeake                  : 76  
                    (Other)                           :805  
                    NA's                              : 20  </code></pre>
</div>
</div>
<p>Now I can clean up and get rid of the data sets in my blog folder.</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-12_ef3f0618de636698c15cb4b0a58ab0a0">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlink</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"./data/*"</span>)</span></code></pre></div>
</div>
<p>Perfect. Hope this helps.</p>


</section>

 ]]></description>
  <guid>https://dyerlab.org/posts/2023-07-19-HUCs/index.html</guid>
  <pubDate>Thu, 20 Jul 2023 04:00:00 GMT</pubDate>
  <media:content url="https://dyerlab.org/posts/2023-07-19-HUCs/featured.png" medium="image" type="image/png" height="113" width="144"/>
</item>
<item>
  <title>Emydine Conservation Symposium</title>
  <link>https://dyerlab.org/posts/2023-07-11-Emydine_Conservation_Symposium/index.html</link>
  <description><![CDATA[ 




<p>It was the first time that I attended and presented at a herp meeting, and it was a great experience. Such a great group of reserachers, agency people, law enforcement, and zoo personnel, all working on projects related to this group of turtles. Really cool experience.</p>
<p><img src="https://dyerlab.org/posts/2023-07-11-Emydine_Conservation_Symposium/heading.png" class="img-fluid"></p>
<p>I was asked to provide an overview of what we’ve been doing in the spotted turtle genetic work. The conference had a tremendously wide variety of topics surrounding these species. Here is the <a href="https://drive.google.com/file/d/1aWJoShwHJGKQt-I4wdEfj1YY2jxm0Khg/view?usp=sharing">agenda</a>.</p>
<p>In addition to myself, there were two other genetics presentations by <a href="https://www.pfw.edu/about-pfw/who-we-are/directories/mark-jordan">Mark Jordan</a> talking about <em>Patterns of standing Genetic variation and Effective population size in Blanding’s Turtle Populations</em> and another by <a href="https://www.umt.edu/environment/personnel/faculty.php?ID=4461">Andrew Whitley</a> on <em>Population genetic analysis of the wood turtle across its us native range.</em> Both of these talks were really well delivered, informative and inspiring.</p>
<p>Here are my slides that I presented along with co-authors <a href="https://dyerlab.org/people">Madison Whitehurst</a> and <a href="https://www.canr.msu.edu/people/caleb-krueger">Caleb Krueger</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://drive.google.com/file/d/1-ZD9zUKUEwVvL8NSWaEiI5SAMrlHBAvh/view?usp=sharing"><img src="https://dyerlab.org/posts/2023-07-11-Emydine_Conservation_Symposium/featured.jpg" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p>It was really nice to get up into the semi-mountainous areas in Pennsylvania (and out of the more humid piedmont of Virginia) for a while.</p>



 ]]></description>
  <guid>https://dyerlab.org/posts/2023-07-11-Emydine_Conservation_Symposium/index.html</guid>
  <pubDate>Tue, 11 Jul 2023 04:00:00 GMT</pubDate>
  <media:content url="https://dyerlab.org/posts/2023-07-11-Emydine_Conservation_Symposium/featured.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>gstudio 1.6.0</title>
  <link>https://dyerlab.org/posts/2023-05-15-gstudio-1.6.0/index.html</link>
  <description><![CDATA[ 




<p><img src="https://dyerlab.org/posts/2023-05-15-gstudio-1.6.0/featured.png" class="img-fluid"></p>
<section id="version-1.6.0" class="level2">
<h2 class="anchored" data-anchor-id="version-1.6.0">Version 1.6.0</h2>
<p>The fixes in this latest version include:</p>
<ul>
<li><p>[REQ] Test for HWP and LD similar to that implemented in Genepop? I work with microsatellite loci that have many rare alleles, so a HWP/LD test with a MC algorithm similar to that used in Genepop would be ideal</p></li>
<li><p>[ADD] Added heirfstat to <code>genetic_structure()</code> to allow functional calling</p></li>
<li><p>[ADD] Added hooks into genetic distances from pegas through <code>genetic_distance()</code> for other distance measures.</p></li>
<li><p>[FIX] stratum He/Ho genetic_diversity <code>Hs()</code></p></li>
<li><p>[FIX] Add permutation to <code>Fst()</code> for significance</p></li>
<li><p>[FIX] <code>pies_on_map</code> apparently is broken</p></li>
<li><p>[FIX] Problem with having a missing genotype for <code>type="column"</code> in first row. Odd problem.</p></li>
<li><p>[ADD] Feedback for reading in columns for <code>read_population()</code> when &gt; 500 loci to provide some level of feedback to the user showing it is doing something and not just sitting there.</p></li>
<li><p>[ADD] Added <code>Hi()</code> (individual heterozygosity) function.</p></li>
<li><p>[FIX] Change ‘locus’ to ‘loci’ in <code>frequency_matrix()</code> to be consistent with the frequencies() function argument list.</p></li>
<li><p>[FIX] Catching problem where empty (instead of <code>NA</code>) data was causing <code>locus(.,type="separated")</code> to fail.</p></li>
</ul>


</section>

 ]]></description>
  <guid>https://dyerlab.org/posts/2023-05-15-gstudio-1.6.0/index.html</guid>
  <pubDate>Mon, 15 May 2023 04:00:00 GMT</pubDate>
  <media:content url="https://dyerlab.org/posts/2023-05-15-gstudio-1.6.0/featured.png" medium="image" type="image/png" height="26" width="144"/>
</item>
<item>
  <title>Population Assignment for Confiscated Spotted Turtles</title>
  <link>https://dyerlab.org/posts/2023-04-27-Population-Assignment/index.html</link>
  <description><![CDATA[ 




<p>Population assignment is the process of determining the likelihood of an individual from originating from a set of <img src="https://latex.codecogs.com/png.latex?K"> populations.</p>
<p><img src="https://dyerlab.org/posts/2023-04-27-Population-Assignment/featured.png" class="img-fluid"></p>
<p>In reality though, confiscated animals are probably not collected from any of the locales from which you’ve sampled to get the allele frequency spectra. So, one goes about the process by using the sample locations to create an assignment surface, showing where <strong>in general</strong> the samples probably came from. Here is just such an application for the endangered turtle species <em>Clemmys guttata</em>.</p>



 ]]></description>
  <guid>https://dyerlab.org/posts/2023-04-27-Population-Assignment/index.html</guid>
  <pubDate>Thu, 27 Apr 2023 04:00:00 GMT</pubDate>
  <media:content url="https://dyerlab.org/posts/2023-04-27-Population-Assignment/featured.png" medium="image" type="image/png" height="109" width="144"/>
</item>
<item>
  <title>ENVS Presenatation at VCESS</title>
  <link>https://dyerlab.org/posts/2023-04-18-Varina-Center-for-Environmenatal-Studies-and-Sustainability/index.html</link>
  <description><![CDATA[ 




<p><img src="https://dyerlab.org/posts/2023-04-18-Varina-Center-for-Environmenatal-Studies-and-Sustainability/featured.png" class="img-fluid"></p>
<p>From their website, they are:</p>
<ul>
<li><p>Comprehensive, student-centered curriculum focusing on the scientific, social, political and historical elements of environmental studies and sustainability.</p></li>
<li><p>Participation in cutting-edge aquatic, terrestrial, and climate studies<br>
</p></li>
<li><p>Experiential and place-based learning in the environmentally and historically rich Varina community</p></li>
<li><p>Dual enrollment credit opportunities available to all students Industry Certification available to all students</p></li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<section id="center-for-environemntal-studies" class="level2">
<h2 class="anchored" data-anchor-id="center-for-environemntal-studies">Center for Environemntal Studies</h2>
<p>The items highlight our undergraduate programs at VCU.</p>
<p>&nbsp;</p>
<section id="student-outdoor-opportunities" class="level3">
<h3 class="anchored" data-anchor-id="student-outdoor-opportunities">Student Outdoor Opportunities</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="ENVS-program-orientation-trip.pdf"><img src="https://dyerlab.org/posts/2023-04-18-Varina-Center-for-Environmenatal-Studies-and-Sustainability/Orientation.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://vcu.exposure.co/scenes-from-footprints-on-the-james"><img src="https://dyerlab.org/posts/2023-04-18-Varina-Center-for-Environmenatal-Studies-and-Sustainability/Footprints.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://vcu.exposure.co/a-research-gem-for-the-river"><img src="https://dyerlab.org/posts/2023-04-18-Varina-Center-for-Environmenatal-Studies-and-Sustainability/RRC.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p>&nbsp;</p>
</section>
</section>
<section id="field-studies" class="level2">
<h2 class="anchored" data-anchor-id="field-studies">Field Studies</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://youtu.be/U05_pxi4-BU"><img src="https://dyerlab.org/posts/2023-04-18-Varina-Center-for-Environmenatal-Studies-and-Sustainability/RiverOfNoReturn.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://youtu.be/ix1Tg66_HkQ"><img src="https://dyerlab.org/posts/2023-04-18-Varina-Center-for-Environmenatal-Studies-and-Sustainability/AvianEcology.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p>&nbsp;</p>
<section id="programmatic-information" class="level3">
<h3 class="anchored" data-anchor-id="programmatic-information">Programmatic Information</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://news.vcu.edu/article/2021/07/how-vcus-center-for-environmental-studies-is-emerging-as-a-national-leader"><img src="https://dyerlab.org/posts/2023-04-18-Varina-Center-for-Environmenatal-Studies-and-Sustainability/Leader.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://docs.google.com/presentation/d/1hPTA-FHR5Pdq4l5rJu0isfjSIILtkdose3Y2xNaaa94/edit?usp=sharing"><img src="https://dyerlab.org/posts/2023-04-18-Varina-Center-for-Environmenatal-Studies-and-Sustainability/slides.png" class="img-fluid figure-img"></a></p>
</figure>
</div>


</section>
</section>

 ]]></description>
  <guid>https://dyerlab.org/posts/2023-04-18-Varina-Center-for-Environmenatal-Studies-and-Sustainability/index.html</guid>
  <pubDate>Tue, 18 Apr 2023 04:00:00 GMT</pubDate>
  <media:content url="https://dyerlab.org/posts/2023-04-18-Varina-Center-for-Environmenatal-Studies-and-Sustainability/featured.png" medium="image" type="image/png" height="131" width="144"/>
</item>
<item>
  <title>Full Data Run</title>
  <link>https://dyerlab.org/posts/2023-02-24-full-dataset/index.html</link>
  <description><![CDATA[ 




<p><img src="https://dyerlab.org/posts/2023-02-24-full-dataset/featured.png" class="img-fluid"></p>
<p>At present, we have 1318 individuals processed and I am waiting on the final 120~ish to finish up this weekend. While these last few are processed and SNPs are called, I am starting to get them configured for analysis (as in actually being able to get answers to this tremendously drawn out process).</p>
<p>This is not the full data set, this is a random subset of the data that has been derived due to time constraints. These data consist of:</p>
<ul>
<li>A 5% random sample of each individuals sequences.</li>
<li>Mapped onto a conservative <em>de novo</em> reference genome assembly that contains only 6,676 contigs. This reference genome was created from 2.5% random sample of each individuals genome as well. See <a href="https://dyerlab.org/posts/2023-01-ddradseq-progress/">this post</a> for more about the assembly and why we chose to use this sized assembly as a reference.</li>
</ul>
<section id="filtering" class="level2">
<h2 class="anchored" data-anchor-id="filtering">Filtering</h2>
<p>To start with, we need to filter the loci. In the current data, we have identified 19,879 sites of potential interest. Next, we filter these down by throwing away ones that do not conform to some rigid tests designed to minimize errors (sequencing errors, etc.). Using <code>vcftools</code>, the first pass of the data was done considering only SNP loci (no sites in insertion/deletion locations), sites with sufficiently high sequencing quality scores (to ensure confidence in identity of nucleotide called by the sequencing machine), sites that have at least 5 individuals possesing a copy of the minor allele (to ignore singletons and rare variants), and with enough sequencing depth (e.g., multiple sequences that are identical) to ensure that we’ve got good genomic regions that are free from any sequencing errors, and have only 2 alleles at the locus.</p>
<p>The table below shows how these filtering options reduced the number of potential sites.</p>
<table class="table">
<thead>
<tr class="header">
<th>Filter</th>
<th>Sites</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Raw</td>
<td>19,879</td>
</tr>
<tr class="even">
<td>QUAL &gt; 20</td>
<td>15,930</td>
</tr>
<tr class="odd">
<td>MAC &gt; 5</td>
<td>10,627</td>
</tr>
<tr class="even">
<td>Depth 10X</td>
<td>1,004</td>
</tr>
<tr class="odd">
<td>2 - alleles</td>
<td>926</td>
</tr>
</tbody>
</table>
<p>From these, I extracted the following derivative components. - site Allele frequencies - site Sequencing depth - site HWE estimates</p>
<p>Then I finished by exporting the filtered data in <code>012</code> allele format and imported it into <code>R</code> using <a href="https://github.com/dyerlab/gstudio/">gstudio</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://dyerlab.org/posts/2023-02-24-full-dataset/filesystem.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Looks good!</figcaption>
</figure>
</div>


</section>

 ]]></description>
  <guid>https://dyerlab.org/posts/2023-02-24-full-dataset/index.html</guid>
  <pubDate>Fri, 24 Feb 2023 05:00:00 GMT</pubDate>
  <media:content url="https://dyerlab.org/posts/2023-02-24-full-dataset/featured.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Removing .DS_Store</title>
  <link>https://dyerlab.org/posts/2023-02-23-remove-ds-store/index.html</link>
  <description><![CDATA[ 




<p>On MacOS, an invisible file named <code>.DS_Store</code> (it is invisible because it starts with a period) can be found in any folder that has some modifications to basic layouts. This is where the metadata is stored that governs view preferences to this folder, icon placement, and other things related to how a user may have customized or modified the appearance of a folder or any manipulation in the Finder.app.</p>
<p>This is all find and dandy until you start doing things like keeping repositories of folders of work in <code>R</code> or other languages using a versioning system like <code>git</code>. As it turns out, these files often change and as such will end up being archived in your add-commit-push workflow. Here is how I get rid of them.</p>
<p>First change to the directory of your repository in the <code>Terminal.app</code> or if you are using <code>RStudio</code>, open the Terminal there in your project (you are using projects, right?).</p>
<pre><code>cd MY_REPO</code></pre>
<p>Next, we can find any and all of them that are currently in the directory tree using the <code>find</code> command. Here are the results of my blog repository.</p>
<pre><code>$ find . -name ".DS_Store"
./manuscripts/apsit-et-al-2002/.DS_Store
./manuscripts/tassone-et-al-2020/.DS_Store
./manuscripts/friedline-et-al-2019/.DS_Store
./manuscripts/flores-manzanero-et-al-2019/.DS_Store
./manuscripts/baker-dyer-2011/.DS_Store
./manuscripts/kelly-dyer-2002/.DS_Store
./manuscripts/smouse-et-al-2001/.DS_Store
./posts/2023-02-20-processing-bam-files/.DS_Store
./posts/2023-02-23-full-dataset/.DS_Store
./posts/.DS_Store
./posts/2022-09-01-markdown/.DS_Store
./posts/2023-02-20-screen-scrolling/.DS_Store
./posts/2023-02-14-Variant-Filtering/.DS_Store
./posts/2022-09-07-Rendering-R-Helpfiles/.DS_Store
./images/.DS_Store</code></pre>
<p>If you have some (such as I did) delete them in a similar manner by appending <code>-delete</code> to the find command.</p>
<pre><code>find . -iname ".DS_Store" -delte</code></pre>
<p>Next, if had previously add any of these into your repository, you will see them as deleted in your git status output. If they are are there, commit the change for deletion as you would normally.</p>
<p>Now, open up your <code>.gitignore</code> file, which should be in the root directory of your repository. If you do not have one, then create one. This file tells <code>git</code> which file patterns to ignore in the future (cryptic naming scheme, no?).</p>
<p>Add <code>.DS_Store</code> on its own line then commit its change. Here is what my <code>.gitignore</code> looks like for this blog repository.</p>
<p><img src="https://dyerlab.org/posts/2023-02-23-remove-ds-store/featured.png" class="img-fluid"></p>
<p>Add your messages and push these commits up to your repository.</p>
<p>You should never have to deal with this again, .DS_Store files will show up but git will never see them.</p>



 ]]></description>
  <guid>https://dyerlab.org/posts/2023-02-23-remove-ds-store/index.html</guid>
  <pubDate>Thu, 23 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>First Filtering Pass for SNP Calling</title>
  <link>https://dyerlab.org/posts/2023-02-22-first-pass/index.html</link>
  <description><![CDATA[ 




<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>( tidyverse)</span></code></pre></div>
</div>
<p>First, I took the new data and made in index and then verged it with the previous VCF files (from <a href="https://dyerlab.org/posts/2023-02-14-variant-filtering/">here</a>). I set up filtering to have a minimum <code>QUAL</code> score of 20, no insertion/deletions, minimum allele count of 5 indiviudals posessing the alternative allele state to have the loci be considered, and only loci with 2 alleles present.</p>
<pre><code>#| eval: false
$ bgzip TotalRawSNPs.vcf 
$ tabix -p vcf TotalRawSNPs.vcf.gz 
$ vcf-merge JK.vcf.gz P.vcf.gz R.vcf.gz S.vcf.gz W.vcf.gz TotalRawSNPs.vcf.gz &gt; FirstRun.vcf
$ vcftools --vcf FirstRun.vcf --remove-indels --minQ 20 --mac 5 --min-alleles 2 --max-alleles 2 --site-depth --out site_depth_summary

VCFtools - 0.1.16
(C) Adam Auton and Anthony Marcketta 2009

Parameters as interpreted:
        --vcf FirstRun.vcf
        --mac 2
        --max-alleles 2
        --min-alleles 2
        --minQ 20
        --out site_depth_summary
        --site-depth
        --remove-indels

After filtering, kept 1410 out of 1410 Individuals
Outputting Depth for Each Site
After filtering, kept 1055 out of a possible 26395 Sites
Run Time = 6.00 seconds</code></pre>
<p>So, I then looked at the distribution of site depths and found the value to cut off the upper 25% percentile. I then filtered all the sites with depth greater than 20X and 3662X. From that I took a look at the distribution of allele frequencies.</p>
<pre><code>vcftools --vcf FirstRun.vcf --remove-indels --minQ 20 --min-meanDP 20 --max-meanDP 3700 --mac 5 --min-alleles 2 --max-alleles 2  --freq --out first_run</code></pre>
<p>This gives me a distribution of loci whose allele frequencies are:</p>
<p><img src="https://dyerlab.org/posts/2023-02-22-first-pass/filtered_maf.png" class="img-fluid"></p>
<p>which leaves me with a reasonable number of loci to work with. At present, there are <img src="https://latex.codecogs.com/png.latex?663"> loci in the data set and if I were to filter at <img src="https://latex.codecogs.com/png.latex?p%3E=0.05"> that would still leave me with 234 to work with. Now let’s convert these into genotypes and start looking at missing data.</p>



 ]]></description>
  <guid>https://dyerlab.org/posts/2023-02-22-first-pass/index.html</guid>
  <pubDate>Wed, 22 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Run FreeBayes, Run!!</title>
  <link>https://dyerlab.org/posts/2023-02-21-freebayes2/index.html</link>
  <description><![CDATA[ 




<p><img src="https://dyerlab.org/posts/2023-02-21-freebayes2/featured.png" class="img-fluid"></p>
<p>So I have somewhere in the vicinity of 1117 samples left to do SNP calling. I thought that I’d just take them and randomly divide them up into 4 groups and then call SNPs on each group. This helps me overcome lack of variation within a particular population.</p>
<p>Here is how I set it up. I have already called SNPs on individuals whose populations start with the letter <em>S, P, J, K, R, and W</em>, so I’m going to exclude all of them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>( tidyverse )</span>
<span id="cb1-2">files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../samples/all005"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.F.fq.gz"</span>)</span>
<span id="cb1-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>( rem <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^S"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^P"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^J"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^K"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^R"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^W"</span>) ) { </span>
<span id="cb1-4">    files[ <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(rem,files) ] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span> </span>
<span id="cb1-5">}</span>
<span id="cb1-6">files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>( files[ <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(files) ], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".F.fq.gz"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) </span>
<span id="cb1-7">folders <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"batch1"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"batch2"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"batch3"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"batch4"</span>)</span>
<span id="cb1-8">moveTo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>( folders, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">floor</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(files)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) ), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"batch1"</span>) </span>
<span id="cb1-9">moveTo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>( moveTo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(moveTo), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span> )</span>
<span id="cb1-10"></span>
<span id="cb1-11">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>( files, moveTo )</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>( df )</span>
<span id="cb1-14"></span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Move the folders into random locations</span></span>
<span id="cb1-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>( i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(df) ) { </span>
<span id="cb1-18">    file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>files[i]</span>
<span id="cb1-19">    cmd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>( <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cp ../../samples/all005/"</span>, file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"* ./"</span>, df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>moveTo[i], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb1-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(i, file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-&gt;"</span>, df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>moveTo[i], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>) )</span>
<span id="cb1-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>( cmd )</span>
<span id="cb1-22">}</span></code></pre></div>
</div>
<p>This coppied over the raw forward and reverse directions for trimmed data, the <code>.bam</code> files for that were mapped onto the same reference, and the index files I recreated after moving stuff around.</p>
<p>I then fired up a <code>srun</code> for each of the folders and ran <code>dDocent</code> on them with no trim, no assembly, no mapping, and yes FreeBayes.</p>
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 28%">
<col style="width: 28%">
<col style="width: 11%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th>Screen</th>
<th>Batch</th>
<th>Start</th>
<th>End</th>
<th>Sites</th>
<th>SNPs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>22326</td>
<td>batch1</td>
<td>2023-02-21 @ 1320</td>
<td>2023-02-21 @ 1401</td>
<td>16103</td>
<td>972</td>
</tr>
<tr class="even">
<td>18933</td>
<td>batch2</td>
<td>2023-02-21 @ 1322</td>
<td>2023-02-21 @ 1322</td>
<td>15257</td>
<td>317</td>
</tr>
<tr class="odd">
<td>15417</td>
<td>batch3</td>
<td>2023-02-21 @ 1325</td>
<td>2023-02-21 @ 1400</td>
<td>15853</td>
<td>453</td>
</tr>
<tr class="even">
<td>15725</td>
<td>batch4</td>
<td>2023-02-21 @ 1327</td>
<td>2023-02-21 @ 1406</td>
<td>16764</td>
<td>1034</td>
</tr>
</tbody>
</table>
<p>I’m not sure why there are such small amounts in <code>batch3</code> and <code>batch4</code>, so I’m just going to do them all in a single lump and see how that goes.</p>



 ]]></description>
  <guid>https://dyerlab.org/posts/2023-02-21-freebayes2/index.html</guid>
  <pubDate>Tue, 21 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Running freebayes</title>
  <link>https://dyerlab.org/posts/2023-02-16-Runing-freebayes/index.html</link>
  <description><![CDATA[ 




<p><img src="https://dyerlab.org/posts/2023-02-16-Runing-freebayes/featured.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>( tidyverse )</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.0      ✔ purrr   0.3.5 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ stringr 1.4.1 
✔ readr   2.1.3      ✔ forcats 0.5.2 
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>( ggrepel )</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() )</span></code></pre></div>
</div>
<p>As a first pass through the data, I split individual sequences into different groups to run <code>bwa</code>. This works on an individual-by-individual basis and with 5% of each individuals genome takes roughly 30 minutes per individual (*1419 individuals …). Doing it in smaller groups allows me to run multiple instances at the same time. See the table <a href="../../posts/2023-01-ddRADSeq-Progress/">here</a> for the groups and current status. At the time of this writing, this process is still waiting on the final 6 groups of samples to be processed.</p>
<p>For a subset of the data, I did call SNPs at the same time that</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://dyerlab.org/posts/2023-02-16-Runing-freebayes/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="batching-freebayes" class="level2">
<h2 class="anchored" data-anchor-id="batching-freebayes">Batching <code>freebayes</code></h2>
<p>To batch these I made a new directory called <code>snpcalling</code> and linked the bam files from a set of indiviudals in several different populations to this folder.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> bam <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> ../samples/O/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.bam<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span>  </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ln</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb4-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span></code></pre></div>
</div>
<p>I then made a small <code>runFreeBayes.sh</code> run file that would</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb5-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ref</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../samples/all005/reference.fasta"</span></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.bam <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> bam.fofn</span>
<span id="cb5-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">freebayes</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--fasta-reference</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ref}</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bam-list</span> bam.fofn <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--vcf</span> Output.vcf</span></code></pre></div>
</div>
<p>I then made it executable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> +x runFreeBayes.sh</span></code></pre></div>
</div>
<p>And made a slurm batch file <code>freebayes.sub</code> which contains</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -N 1</span></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -n 36</span></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -t 96:00:00</span></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -J freebayesbaby</span></span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -o freebayes.o%j</span></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -e freebayes.e%j</span></span>
<span id="cb7-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-user=rjdyer@vcu.edu</span></span>
<span id="cb7-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mail-type=ALL</span></span>
<span id="cb7-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">ulimit</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> unlimited</span>
<span id="cb7-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">./runFreeBayes.sh</span></span>
<span id="cb7-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scontrol</span> show job <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_JOB_ID</span></span></code></pre></div>
</div>
<p>and then dumped it off for batch processing</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sbatch</span> freebayes.sub</span></code></pre></div>
</div>
<p>After this, you can see that the batch job has been queued up (#34827) and waiting to go.</p>
<pre><code>[rjdyer@huff snpcalling]$ squeue
  JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
  34827     basic freebaye   rjdyer PD       0:00      1 (Priority)
  34828     basic freebaye   rjdyer PD       0:00      1 (Priority)</code></pre>
<p>So, now lets see if it actually works. This run has 293 samples and the next one (#34828) has 270.</p>


</section>

 ]]></description>
  <guid>https://dyerlab.org/posts/2023-02-16-Runing-freebayes/index.html</guid>
  <pubDate>Tue, 21 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Pre-Processing Bam Files 🐢</title>
  <link>https://dyerlab.org/posts/2023-02-20-processing-bam-files/index.html</link>
  <description><![CDATA[ 




<p><img src="https://dyerlab.org/posts/2023-02-20-processing-bam-files/featured.png" class="img-fluid"></p>
<p>For this, I wanted to sort, mark duplicates, and index each of the bam files we are working with. I softlinked all the bam files into a new folder called <code>processing</code> via <code>for file in ../samples/all005/*.bam; do ln -s $file; done</code>.</p>
<p>Then I fired up R and loaded the latest modeule on the server <code>module load R/4.1.2</code> and then hooked up VSCode over SSH to write the following snippet.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>( tidyverse )</span>
<span id="cb1-2"></span>
<span id="cb1-3">bam <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"./processing"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".bam"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full.names=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb1-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>( i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(bam) ) { </span>
<span id="cb1-5">    file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bam[i]</span>
<span id="cb1-6">    base <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>( file, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-RG.bam"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replacement=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb1-7"></span>
<span id="cb1-8">    fsorted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>( base, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-sorted.bam"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb1-9">    cmd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>( <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools sort"</span>, file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-o"</span>, fsorted )</span>
<span id="cb1-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>( cmd )</span>
<span id="cb1-11"></span>
<span id="cb1-12">    mdfile <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>( base, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-sorted-md.bam"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb1-13">    cmd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>( <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools markdup"</span>, fsorted, mdfile )</span>
<span id="cb1-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>( cmd )</span>
<span id="cb1-15"></span>
<span id="cb1-16">    cmd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>( <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"samtools index"</span>, mdfile)</span>
<span id="cb1-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">system</span>( cmd )</span>
<span id="cb1-18"></span>
<span id="cb1-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>( i, base, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-20">}</span></code></pre></div>
</div>
<p>Running this made several derivded files for each one, a sorted one, a one with marked duplicates, and one that had the index on it. So now each sample looks like this.</p>
<pre><code>[rjdyer@huff10 4_processing]$ ls -1 Zoo_969*
Zoo_969-RG.bam -&gt; ../samples/all005/Zoo_969-RG.bam
Zoo_969-sorted.bam
Zoo_969-sorted-md.bam
Zoo_969-sorted-md.bam.bai</code></pre>
<p>After testing to make sure the commands were properly set up, I ran the script in as a batch. It didn’t take that long to finish, maybe 3-4 seconds per sample.</p>



 ]]></description>
  <guid>https://dyerlab.org/posts/2023-02-20-processing-bam-files/index.html</guid>
  <pubDate>Mon, 20 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Scrolling Back using ‘Screen’</title>
  <link>https://dyerlab.org/posts/2023-02-20-screen-scrolling/index.html</link>
  <description><![CDATA[ 




<p><img src="https://dyerlab.org/posts/2023-02-20-screen-scrolling/featured.png" class="img-fluid"></p>
<p>I use <code>screen</code> a lot to do stuff on remote servers and one of the things that annoyed me is that it appears that when you are in a <code>screen</code> session, and you flick the scroll wheel backwards, it simply goes back through the history of commands on the same command line. The indended behavior, would be like the normal terminal, when not in a <code>screen</code> session, and the terminal would scroll up/down..</p>
<p>Apparently <code>screen</code> has some kind of buffer that prevents this for reason I cannot tell you. To fix it, create a <code>.screenrc</code> file in your home directory (if it does not already exist) and put the following line of code in it.</p>
<pre><code>termcapinfo xterm* ti@:te@</code></pre>
<p>Makes total sense, right? Sometimes I get so frustrated that things need to be so complicated. Simplicity people! Let’s focus on <a href="../../posts/1969-10-14-Dyers-Philosophy-Of-Life">removing stuff that sucks</a> from our lives!</p>



 ]]></description>
  <guid>https://dyerlab.org/posts/2023-02-20-screen-scrolling/index.html</guid>
  <pubDate>Mon, 20 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Using R on VSCode Remotely</title>
  <link>https://dyerlab.org/posts/2022-11-17-VSCode-Remote/index.html</link>
  <description><![CDATA[ 




<section id="seting-up-r-and-vscode" class="level2">
<h2 class="anchored" data-anchor-id="seting-up-r-and-vscode">Seting up R and VSCode</h2>
<p>First of all, we’ll need to install some stuff on the <code>R</code> side. The language serve is necessary for VSCode and the httpgd is helpful for viewing graphical output. The following code will check to see if you have them installed and if not, install them for you.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">require</span>(languageserver) ) { </span>
<span id="cb1-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"languageserver"</span>)</span>
<span id="cb1-3">}</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: languageserver</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">require</span>(httpgd)) { </span>
<span id="cb3-2">  remotes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install_github</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nx10/httpgd"</span>)</span>
<span id="cb3-3">}</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: httpgd</code></pre>
</div>
</div>
<p>Now, download <a href="https://code.visualstudio.com/">VSCode</a> from the main server. You will also need to install the <a href="https://marketplace.visualstudio.com/items?itemName=REditorSupport.r">R Extension for Visual Studio Code</a>, which can be installed from inside VSCode.</p>
</section>
<section id="making-secure-connections" class="level2">
<h2 class="anchored" data-anchor-id="making-secure-connections">Making Secure Connections</h2>
</section>
<section id="remote-work" class="level2">
<h2 class="anchored" data-anchor-id="remote-work">Remote Work</h2>


</section>

 ]]></description>
  <guid>https://dyerlab.org/posts/2022-11-17-VSCode-Remote/index.html</guid>
  <pubDate>Mon, 20 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Variant Filtering</title>
  <link>https://dyerlab.org/posts/2023-02-14-Variant-Filtering/index.html</link>
  <description><![CDATA[ 




<section id="merging-vcf-files" class="level2">
<h2 class="anchored" data-anchor-id="merging-vcf-files">Merging VCF Files</h2>
<p>The first thing we need to to is zip and then index the individual vcf files. As a reminder, these files have been created by individual <code>freebayes</code> SNP calling of chunks of individuals partitioned into groups based upon the first letter of the popualtion from which they were collected. So, in the following examples, the file <code>R.vcf</code> contains all the individuals in populations starting with the letter <code>R</code>. When there are not that many individuals in a group, they are clustered—below we have <code>JK.vcf</code> which has all the individuals from populations starting with the letters <code>J</code> and <code>K</code>.</p>
<p>So, lets compress these raw files first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> bgzip JK.vcf</span>
<span id="cb1-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> bgzip P.vcf </span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> bgzip R.vcf </span>
<span id="cb1-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> bgzip S.vcf </span>
<span id="cb1-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> bgzip W.vcf</span>
<span id="cb1-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> ls <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-alh</span></span>
<span id="cb1-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">total</span> 70032</span>
<span id="cb1-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">drwxr-xr-x</span>   7 rodney  staff   224B Feb 16 14:22 .</span>
<span id="cb1-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">drwxr-xr-x</span>  21 rodney  staff   672B Feb 16 14:10 ..</span>
<span id="cb1-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-rw-r--r--</span>   1 rodney  staff   3.1M Feb 16 14:20 JK.vcf.gz</span>
<span id="cb1-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-rw-r--r--</span>   1 rodney  staff   5.8M Feb 16 14:22 P.vcf.gz</span>
<span id="cb1-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-rw-r--r--</span>   1 rodney  staff   4.6M Feb 16 14:22 R.vcf.gz</span>
<span id="cb1-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-rw-r--r--</span>   1 rodney  staff    14M Feb 16 14:22 S.vcf.gz</span>
<span id="cb1-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-rw-r--r--</span>   1 rodney  staff   5.8M Feb 16 14:22 W.vcf.gz</span></code></pre></div>
</div>
<p>Now we need to index these files.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> tabix <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> vcf JK.vcf.gz </span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> tabix <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> vcf P.vcf.gz </span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> tabix <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> vcf R.vcf.gz</span>
<span id="cb2-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> tabix <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> vcf S.vcf.gz</span>
<span id="cb2-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> tabix <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> vcf W.vcf.gz</span></code></pre></div>
</div>
<p>Then we can merge the files together into a single file. Here, the output file indicates the populations that contribute to it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> vcf-merge JK.vcf.gz P.vcf.gz R.vcf.gz S.vcf.gz W.vcf.gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> JKPRSW.vcf</span></code></pre></div>
</div>
<p>So here are a few things that I’ve found that provide some insights into the data we are getting. Here is the sequencing depth per individual for only the SNP sites who have a minimum quality score of 20.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> vcftools <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--vcf</span> JKPRSW.vcf <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--remove-indels</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--minQ</span> 20 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--depth</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> depth.txt</span></code></pre></div>
</div>
<p>This produced a distribution of sequencing depths for these individuals.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://dyerlab.org/posts/2023-02-14-Variant-Filtering/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 1 Average sequencing depth across loci within each of the 302 individuals.</figcaption>
</figure>
</div>
</div>
</div>
<p>Alternatively—and perhaps more important for us—we can look at the per-site depths. The goal here is to retain sites that have enough sequencing depth such that we are confident that it is a good site but not too much such that it is a reapeaty region in the geniome. For simplicity, I’ll drop the lower and upper standard deviation.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://dyerlab.org/posts/2023-02-14-Variant-Filtering/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure 2 Average sequencing depth per site across 302 individuals.</figcaption>
</figure>
</div>
</div>
</div>
<p>For simplicity, I’m just going to take the inner-50% of the data, dropping off the lower and upper quantiles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>( site_depth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>SUM_DEPTH,</span>
<span id="cb5-2">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>25% 75% 
110 964 </code></pre>
</div>
</div>
<p>This leaves us with 5047 sites.</p>
<p>Now, we can go back to <code>vcftools</code> and use these values to select only sites with a quality score exceeding 20, and are in the middle 50 percentile of the depth coverage and have a minor allele frequency of at least 5%.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%</span> vcftools <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--vcf</span> JKPRSW.vcf <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--remove-indels</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--min-meanDP</span> 110 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-meanDP</span> 964 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--minQ</span> 20 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--maf</span> 0.05  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--min-alleles</span> 2 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-alleles</span> 2 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--freq</span></span>
<span id="cb7-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">After</span> filtering, kept 302 out of 302 Individuals</span>
<span id="cb7-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Outputting</span> Frequency Statistics...</span>
<span id="cb7-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">After</span> filtering, kept 120 out of a possible 22604 Sites</span>
<span id="cb7-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Run</span> Time = 1.00 seconds</span></code></pre></div>
</div>
<p>So, we have 120 loci to work with from this subset.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="https://dyerlab.org/posts/2023-02-14-Variant-Filtering/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>

 ]]></description>
  <guid>https://dyerlab.org/posts/2023-02-14-Variant-Filtering/index.html</guid>
  <pubDate>Fri, 17 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Reset Github User for Push</title>
  <link>https://dyerlab.org/posts/2023-02-16-github-reset-user/index.html</link>
  <description><![CDATA[ 




<p><img src="https://dyerlab.org/posts/2023-02-16-github-reset-user/featured.png" class="img-fluid"></p>
<p>So I was working on a repository at home that I set up on another github acount, for another entity. In doing so, I clobbered my <code>global</code> github <code>user</code> and <code>user.email</code> values and as such when I tried to <code>git push</code> none of the changes would go because it could not authenticate. Instead I got this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rodney$</span> git push</span>
<span id="cb1-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">remote:</span> Permission to dyerlab/DLabWebsite.git denied to windbunny.</span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fatal:</span> unable to access <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://github.com/dyerlab/DLabWebsite.git/'</span>: The requested URL returned error: 403</span></code></pre></div>
</div>
<p>So, what you have to do is reconfigure the <code>username</code>, <code>user.email</code>, and <code>remote.origin.url</code> to reset your user name for ssh/https pushing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rodney$</span> git config user.name dyerlab</span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rodney$</span> git config user.email rjdyer@vcu.edu</span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rodney$</span> git config remote.origin.url https://dyerlab@github.com/dyerlab/DLabWebsite.git</span></code></pre></div>
</div>
<p>Then the next time you <code>push</code> it (go Salt-n-Pepper), it will ask for your authentication token again. Enter it and you are good.</p>



 ]]></description>
  <guid>https://dyerlab.org/posts/2023-02-16-github-reset-user/index.html</guid>
  <pubDate>Thu, 16 Feb 2023 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Turtle ddRADSeq Project</title>
  <link>https://dyerlab.org/posts/2023-01-ddRADSeq-Progress/index.html</link>
  <description><![CDATA[ 




<p><img src="https://dyerlab.org/posts/2023-01-ddRADSeq-Progress/featured.png" class="img-fluid"></p>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>We retrieved usable sequence data from at total of 1419 individuals. The number of sequence reads is depicted by file size (log base 10) below.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://dyerlab.org/posts/2023-01-ddRADSeq-Progress/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">The distrubiton of sequence reads (denoted as log10 of file size) for all individuals sequenced.</figcaption>
</figure>
</div>
</div>
</div>
<p>The largest number of sequences was retrieved from a sample from Camp Edwards, MA, with 50,205,568 sequences. The median read size was 17,332,284.</p>
</section>
<section id="processing" class="level2">
<h2 class="anchored" data-anchor-id="processing">Processing</h2>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://dyerlab.org/posts/2023-01-ddRADSeq-Progress/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Progress of the main steps in processing raw sequence data.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="progress" class="level2">
<h2 class="anchored" data-anchor-id="progress">Progress</h2>
<p>The following logs document the initial attempts at implementing the <a href="https://www.ddocent.com">dDocent</a> workflow for processing NovoSEQ data on the spotted turtle.</p>
<ul>
<li><a href="../../posts/2022-10-05-ddradseq">Demultiplexing</a> is the process of taking all the data that is mixed together and turning it inot a a bunch of files, one for each individual, based upon the individual barcodes.</li>
<li>The <a href="../../posts/2023-01-21-first-ddocent-run/">first run</a> of <a href="http://ddocent.com/">dDocent</a> crashed almost immediately.</li>
<li>The <a href="../../2023-01-25-second-ddocent-run/">second run</a> of <a href="http://ddocent.com/">dDocent</a> also crashed, but this time it was for a different reason. Apparently, the node it was running on was failing. However, it still crashed.</li>
<li>As a result of these attempts, it appears that the data are just <em>too big</em> and I need to take subsets of the data to work with so the computers can actually get something done. So, after talking with a colleague about it, I <a href="../../posts/2023-01-12-right-sizing-sequences/">right-sized</a> the data <em>first</em> in random samples and then ran a <a href="../../posts/2023-01-25-a-10percent-full-data-run/">third</a> run used a random subset of 10% of each individuals reads to make a synthetic “individual”. It ultimately failed at the end as well.</li>
<li>So, lessons learned. I needed to create a random subset of my data and use that for <strong>just</strong> the assembly portion of this process. So I set out to do that and found results.
<ul>
<li>A <a href="../../posts/2023-01-30-2pt5pct-ddocent-run/">2.5% subset</a> finished with 7k contigs.</li>
<li>A <a href="../../posts/2023-01-31-5pct-ddocent-run/">5% subset</a> finished with 58k contigs.</li>
<li>A <a href="../../posts/2023-01-27-10pct-ddocent-run/">10% subset</a> finished with 400k contigs.</li>
</ul></li>
<li>So, I can now start mapping. At first, I took the reference genome from the <a href="../../posts/2023-01-30-2pt5pct-ddocent-run/">2.5% subset</a> and took the raw data again (all the reads for each indiviudal) and used <code>bwa</code> to assemble and <code>FreeBayes</code> to call SNPs. Unfortunately, since the number of reads for each individual is somewhere in the range of 3 - 33 million reads, it takes a bit of time. Right now, it is averaging 11 hours per individual * 1419 individuals which is 650.375 days (meaning it will be done on 2024-11-13). This run is still going and unless it dies at some point, I am going to allow it to keep running…</li>
<li>Again, to take a random subset seems to be the way to go. In what follows is my current approach to this, which started on 2 February 2022.</li>
</ul>
<section id="workflow-progress" class="level3">
<h3 class="anchored" data-anchor-id="workflow-progress">Workflow Progress</h3>
<p>So I started up a individuals processes to map and call SNPs. It is done using <a href="https://slurm.schedmd.com">slurm</a> on our clusters so I fire up an instance on one of the compute nodes as:</p>
<p>As a first mapping run, I had a single process (that one used 64G of memory and was way too much for what <code>bwa</code> and <code>FreeBayes</code> seem to need). The data being used in this run include:</p>
<ul>
<li>A new random selection of 5% of each individuals genome.<br>
</li>
<li>The assembly created from the 2.5% random selection of each individual.</li>
</ul>
<p>This was started on 2 February 2023 and appears to be taking roughly 30 minutes per indivudal to allow <code>bwa</code> to map. Below is the progress to date.</p>
<div class="cell fig-cap-location-top">
<div class="cell-output-display">

<table class=" lightable-paper lightable-hover" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Population
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:left;">
Demultiplexed
</th>
<th style="text-align:left;">
Filtered
</th>
<th style="text-align:left;">
Mapped
</th>
<th style="text-align:right;">
Sites
</th>
<th style="text-align:left;">
SNPs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
L
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">102</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
102
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
84
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
E
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
G
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
H
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
I
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
J
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
9367
</td>
<td style="text-align:left;">
<span style=" font-weight: bold;    color: green !important;">1508</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
K
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
9367
</td>
<td style="text-align:left;">
<span style=" font-weight: bold;    color: green !important;">1508</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
M
</td>
<td style="text-align:right;">
129
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
N
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
O
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
11338
</td>
<td style="text-align:left;">
<span style="  font-style: italic;   color: red !important;">282</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
10730
</td>
<td style="text-align:left;">
<span style=" font-weight: bold;    color: green !important;">1660</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Q
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
7100
</td>
<td style="text-align:left;">
<span style="  font-style: italic;   color: red !important;">188</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
R
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
10294
</td>
<td style="text-align:left;">
<span style=" font-weight: bold;    color: green !important;">1348</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
S
</td>
<td style="text-align:right;">
187
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
15089
</td>
<td style="text-align:left;">
<span style=" font-weight: bold;    color: green !important;">1994</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
T
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
11986
</td>
<td style="text-align:left;">
<span style="  font-style: italic;   color: red !important;">176</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
V
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
8586
</td>
<td style="text-align:left;">
<span style="  font-style: italic;   color: red !important;">58</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
W
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 100.00%">100</span>
</td>
<td style="text-align:left;width: 3cm; ">
<span style="display: inline-block; direction: rtl; unicode-bidi: plaintext; border-radius: 4px; padding-right: 2px; background-color: lightgreen; width: 98.04%">100</span>
</td>
<td style="text-align:right;">
10891
</td>
<td style="text-align:left;">
<span style=" font-weight: bold;    color: green !important;">1113</span>
</td>
</tr>
</tbody>

</table>
<p>Table 1 Current progress on bioinformatic workflows.</p>
</div>
</div>
<p>At present, there are -2 samples remaining to be mapped.</p>


</section>
</section>

 ]]></description>
  <guid>https://dyerlab.org/posts/2023-01-ddRADSeq-Progress/index.html</guid>
  <pubDate>Wed, 15 Feb 2023 05:00:00 GMT</pubDate>
</item>
</channel>
</rss>
